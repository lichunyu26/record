function e(e,r){var t;return e="object"==typeof(t=e)&&null!==t?e:Object.create(null),new Proxy(e,{get:(e,t,o)=>"key"===t?Reflect.get(e,t,o):Reflect.get(e,t,o)||Reflect.get(r,t,o)})}function r(e,{storage:r,serializer:t,key:o,debug:s}){try{const s=null==r?void 0:r.getItem(o);s&&e.$patch(null==t?void 0:t.deserialize(s))}catch(n){s&&console.error(n)}}function t(e,{storage:r,serializer:t,key:o,paths:s,debug:n}){try{const n=Array.isArray(s)?function(e,r){return r.reduce(((r,t)=>{const o=t.split(".");return function(e,r,t){return r.slice(0,-1).reduce(((e,r)=>/^(__proto__)$/.test(r)?{}:e[r]=e[r]||{}),e)[r[r.length-1]]=t,e}(r,o,function(e,r){return r.reduce(((e,r)=>null==e?void 0:e[r]),e)}(e,o))}),{})}(e,s):e;r.setItem(o,t.serialize(n))}catch(i){n&&console.error(i)}}function o(o={}){return s=>{const{auto:n=!1}=o,{options:{persist:i=n},store:l,pinia:a}=s;if(!i)return;if(!(l.$id in a.state.value)){const e=a._s.get(l.$id.replace("__hot:",""));return void(e&&Promise.resolve().then((()=>e.$persist())))}const c=(Array.isArray(i)?i.map((r=>e(r,o))):[e(i,o)]).map((({storage:e=localStorage,beforeRestore:r=null,afterRestore:t=null,serializer:s={serialize:JSON.stringify,deserialize:JSON.parse},key:n=l.$id,paths:i=null,debug:a=!1})=>{var c;return{storage:e,beforeRestore:r,afterRestore:t,serializer:s,key:(null!=(c=o.key)?c:e=>e)("string"==typeof n?n:n(l.$id)),paths:i,debug:a}}));l.$persist=()=>{c.forEach((e=>{t(l.$state,e)}))},l.$hydrate=({runHooks:e=!0}={})=>{c.forEach((t=>{const{beforeRestore:o,afterRestore:n}=t;e&&(null==o||o(s)),r(l,t),e&&(null==n||n(s))}))},c.forEach((e=>{const{beforeRestore:o,afterRestore:n}=e;null==o||o(s),r(l,e),null==n||n(s),l.$subscribe(((r,o)=>{t(o,e)}),{detached:!0})}))}}export{o as c};
